<!DOCTYPE html>
<html>
<head>
	<title>Setup Apache VirtualHost in Ubuntu | Book Of Zeus</title>
	<meta name="description" content="Setup multiple domains using the Apache VirtualHost in Ubuntu" />
	<meta name="author" content="Book Of Zeus" />
	<meta name="robots" content="index, follow" />
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />

	<meta name="google-site-verification" content="5IAePxZxNggUiJp9G82ARb7Wfo7AOTEpa-WHjEiwt1g" />
	<meta name="msvalidate.01" content="B5DFA066FA5291D9CB34785B1BC6675D" />
	<meta name="alexaVerifyID" content="vQHSFVDphyxYyFdLXh_rjrFaCwc" />
	<meta name="y_key" content="1541c56d97401c05" />	

	<meta name="DC.Creator" content="Book Of Zeus" />
	<meta name="DC.Language" content="en" />

	<link href="https://plus.google.com/109493568868519843460" rel="publisher" />

	<link rel="author" href="https://plus.google.com/109493568868519843460">
	<link rel="shortcut icon" href="/media/favicon.ico" />
	<link rel="icon" href="/media/favicon.ico" />


	<link rel="image_src" href="/media/logo.png" />

	<link rel="canonical" href="http://bookofzeus.com/articles/apache/setup-apache-virtualhost-in-ubuntu" />
	<link rel="stylesheet" type="text/css" href="/media/modern.css" media="all" />
	<link href='http://fonts.googleapis.com/css?family=Muli' rel='stylesheet' type='text/css'>

	<script type="text/javascript">
	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-23468853-1']);
	  _gaq.push(['_trackPageview']);
	  (function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();
	</script>
</head>
<body id="body">

<!-- rss -->

<div id="rss">
	<a href="/rss.xml"><img src="/media/rss.png" alt="rss feed"></a>
	<a href="http://twitter.com/bookofzeus" target="_blank"><img src="/media/twitter.png" alt="Twitter Page"></a>
	<a href="https://www.facebook.com/bookofzeus" target="_blank"><img src="/media/facebook.png" alt="Facebook Page"></a>
	<a href="https://github.com/bookofzeus" target="_blank"><img src="/media/github.png" alt="Github Page"></a>
	<a href="https://stackoverflow.com/users/905093/book-of-zeus" target="_blank"><img src="/media/sof.png" alt="Stack Over Flow Page"></a>

</div>

<!-- menu -->
<div id="menu">
	<img src="/media/menu.png" class="nav-toggler toggle-slide-left" alt="show or hide menu" width="24" height="24" />
	<div id="home2">
		Book<span>Of</span>Zeus
	</div>
</div>

<aside class="menu slide-menu-left">
	<header id="home">
		<div>
			<img src="/media/logo.png" alt="logo" width="57" height="57" />
			Book<span>Of</span>Zeus
		</div>
		<span>Articles, Tutorials &amp; Source Code</span>
	</header>

	<nav>
		<button class="close-menu">Close Menu</button>
		<ul>

	<li class="header"><a href="/arduino/" title="Arduino" >Arduino</a>
	
		<ul>
		
			<li class="item"><a href="/arduino/sensor-module-cheat-sheet/" title="Sensor and Module Cheat Sheet" >Sensor and Module Cheat Sheet</a></li>
		
		</ul>
	
	</li>

	<li class="header"><a href="/articles/" title="Articles" class="selected">Articles</a>
	
		<ul>
		
			<li class="item"><a href="/articles/android/" title="Android" >Android</a></li>
		
			<li class="item"><a href="/articles/apache/" title="Apache" class="selected">Apache</a></li>
		
			<li class="item"><a href="/articles/css/" title="CSS" >CSS</a></li>
		
			<li class="item"><a href="/articles/docker/" title="Docker" >Docker</a></li>
		
			<li class="item"><a href="/articles/documentation/" title="Documentation" >Documentation</a></li>
		
			<li class="item"><a href="/articles/git/" title="Git" >Git</a></li>
		
			<li class="item"><a href="/articles/html/" title="HTML" >HTML</a></li>
		
			<li class="item"><a href="/articles/java/" title="Java" >Java</a></li>
		
			<li class="item"><a href="/articles/javascript/" title="Javascript" >Javascript</a></li>
		
			<li class="item"><a href="/articles/jquery/" title="jQuery" >jQuery</a></li>
		
			<li class="item"><a href="/articles/linux/" title="Linux" >Linux</a></li>
		
			<li class="item"><a href="/articles/mobile/" title="Mobile" >Mobile</a></li>
		
			<li class="item"><a href="/articles/mongodb/" title="Mongo" >Mongo</a></li>
		
			<li class="item"><a href="/articles/mysql/" title="MySQL" >MySQL</a></li>
		
			<li class="item"><a href="/articles/optimization/" title="Optimization" >Optimization</a></li>
		
			<li class="item"><a href="/articles/php/" title="PHP" >PHP</a></li>
		
			<li class="item"><a href="/articles/python/" title="Python" >Python</a></li>
		
			<li class="item"><a href="/articles/sass/" title="Sass" >Sass</a></li>
		
			<li class="item"><a href="/articles/subversion/" title="Subversion" >Subversion</a></li>
		
		</ul>
	
	</li>

	<li class="header"><a href="/contribute/" title="Contribute" >Contribute</a>
	
	</li>

	<li class="header"><a href="/customize-ubuntu/" title="Customize Ubuntu" >Customize Ubuntu</a>
	
		<ul>
		
			<li class="item"><a href="/customize-ubuntu/editor/" title="Editor" >Editor</a></li>
		
			<li class="item"><a href="/customize-ubuntu/environment/" title="Environment" >Environment</a></li>
		
			<li class="item"><a href="/customize-ubuntu/flash-player/" title="Flash Player" >Flash Player</a></li>
		
			<li class="item"><a href="/customize-ubuntu/fonts/" title="Fonts" >Fonts</a></li>
		
			<li class="item"><a href="/customize-ubuntu/icons/" title="Icons" >Icons</a></li>
		
			<li class="item"><a href="/customize-ubuntu/indicator/" title="Indicator" >Indicator</a></li>
		
			<li class="item"><a href="/customize-ubuntu/install/" title="Install" >Install</a></li>
		
			<li class="item"><a href="/customize-ubuntu/keyboard-shortcuts/" title="Keyboard Shortcuts" >Keyboard Shortcuts</a></li>
		
			<li class="item"><a href="/customize-ubuntu/live-cd/" title="Live CD" >Live CD</a></li>
		
			<li class="item"><a href="/customize-ubuntu/packages/" title="Packages" >Packages</a></li>
		
			<li class="item"><a href="/customize-ubuntu/privacy/" title="Privacy" >Privacy</a></li>
		
			<li class="item"><a href="/customize-ubuntu/settings/" title="Settings" >Settings</a></li>
		
			<li class="item"><a href="/customize-ubuntu/themes/" title="Themes" >Themes</a></li>
		
			<li class="item"><a href="/customize-ubuntu/window/" title="Window" >Window</a></li>
		
		</ul>
	
	</li>

	<li class="header"><a href="/harden-ubuntu/" title="Harden Ubuntu" >Harden Ubuntu</a>
	
		<ul>
		
			<li class="item"><a href="/harden-ubuntu/initial-setup/" title="Initial Setup" >Initial Setup</a></li>
		
			<li class="item"><a href="/harden-ubuntu/server-setup/" title="Server Setup" >Server Setup</a></li>
		
			<li class="item"><a href="/harden-ubuntu/disable-services/" title="Disabled Services" >Disabled Services</a></li>
		
			<li class="item"><a href="/harden-ubuntu/hardening/" title="Hardening" >Hardening</a></li>
		
			<li class="item"><a href="/harden-ubuntu/monitoring-tools/" title="Monitoring Tools" >Monitoring Tools</a></li>
		
			<li class="item"><a href="/harden-ubuntu/optimization/" title="Optimization" >Optimization</a></li>
		
			<li class="item"><a href="/harden-ubuntu/software/" title="Software" >Software</a></li>
		
			<li class="item"><a href="/harden-ubuntu/useful-commands/" title="Useful Commands" >Useful Commands</a></li>
		
			<li class="item"><a href="/harden-ubuntu/backup/" title="Backup" >Backup</a></li>
		
		</ul>
	
	</li>

</ul>
	</nav>

</aside>

<!-- content -->
<section>
	<article class="breadcrumbs">
	<a title="Book Of Zeus" href="/">Book Of Zeus</a> &gt; <a title="articles" href="/articles/">articles</a> &gt; <a title="apache" href="/articles/apache/">apache</a>
</article>

<article>
	<header>
		<h1>Setup Apache VirtualHost in Ubuntu</h1>
		<h6>Posted on Sunday February 19, 2012 by Eric Potvin</h6>
	</header>

	<p>If you run multiple sites (including multiple domains) on the same hosting plan, you will have to setup each of them before using them, otherwise all the domains will go the same place.</p>

<p>Here's a quick solution to efficiently maintain all these domains and easily enable or disable some in case of emergency.</p>

<p>For this article we will use three (3) domains:</p>
<ul>
 <li>domain1.com</li>
 <li>domain2.com</li>
 <li>domain2.net</li>
</ul>

<p>The ".com" domains has nothing in common and the ".net" domain belongs to domain2.com. The "domain1.com" belongs to you and the "domain2.com" and "domain2.net" belongs to a friend.</p>

<h4>Preparing the folder directory</h4>
<p>Let's create the directory structure. Let's create the structure for the "domain1.com". Because this domain belongs to you, you can use the default webroot <code>/var/www/</code> or <code>/usr/local/httpd/</code>.</p>

<pre>
sudo -p mkdir /var/www/domain1.com/public_html/
chown myuser:myuser 755 /var/www/domain1.com/
</pre>

<p>Now, let's create the account for the second domain.</p>
<pre>
bookofzeus@ubuntu:~$ sudo adduser domain1
</pre>

<p>This will display something like:</p>
<pre>
[sudo] password for bookofzeus:
Adding user `domain2' ...
Adding new group `domain2' (1001) ...
Adding new user `domain2' (1001) with group `domain2' ...
Creating home directory `/home/domain2' ...
Copying files from `/etc/skel' ...
Enter new UNIX password:
Retype new UNIX password:
passwd: password updated successfully
Changing the user information for domain2
Enter the new value, or press ENTER for the default
	Full Name []: John Doe
	Room Number []:
	Work Phone []:
	Home Phone []:
	Other []:
Is the information correct? [Y/n] y
</pre>
<p>This will create the account and the folder structure for the user.</p>
<p>Now, let's create the public_html where the website files will be uploaded.</p>
<pre>
sudo mkdir -p /home/domain2/{public_html,private,logs}
</pre>

<p>Let's give the permissions:</p>
<pre>
sudo chown -R domain2:domain2 /home/domain2/
</pre>
<p>This will create the basic structure:</p>
<pre>
bookofzeus@ubuntu:/home/domain2$ ll
total 12
drwxr-xr-x 2 domain2 domain2 4096 2012-02-20 07:46 logs
drwxr-xr-x 2 domain2 domain2 4096 2012-02-20 07:46 private
drwxr-xr-x 2 domain2 domain2 4096 2012-02-20 07:46 public_html
</pre>

<h4>Setup the VirtualHost</h4>
<p>Now the directory structure is created, we can setup the VirtualHost.</p>
<p>Make sure the <code>sites-enabled</code> is in the apache configuration. If not, you need to add it to the file.</p>
<pre>
sudo vi /etc/apache2/apache2.conf
</pre>
<p>And add the following line:</p>
<pre>
# Include the virtual host configurations:
Include sites-enabled/
</pre>
<p>Now, let's create the configuration file for both domains. Let's create the first domain (domain1.com).</p>
<pre>
vi /etc/apache2/sites-available/domain1.conf
</pre>

<p>and use the following config:</p>
<pre>
&lt;VirtualHost *:80&gt;
 DocumentRoot "/var/www/domain1.com/"
 ServerName domain1.com
 ServerAlias domain1.com www.domain1.com
 &lt;Directory "/var/www/domain1.com/"&gt;
  allow from all
  Options +Indexes
 &lt;/Directory&gt;
&lt;/VirtualHost&gt;
</pre>
<p>Same idea for the domain2 (.com and .net)</p>
<pre>
vi /etc/apache2/sites-available/domain2.conf
</pre>
<p>and use the following config:</p>
<pre>
&lt;VirtualHost *:80&gt;
 DocumentRoot "/home/domain2/public_html/"
 ServerName domain2.com
 ServerAlias domain2.com www.domain2.com domain2.net www.domain2.net

 LogLevel warn
 ErrorLog  /home/domain2/logs/error.log
 CustomLog /home/domain2/logs/access.log combined

 &lt;Directory "/home/domain2/public_html/"&gt;
  allow from all
  Options +Indexes
 &lt;/Directory&gt;
&lt;/VirtualHost&gt;
</pre>

<p class="note">You notice the <code>ServerAlias</code> use both .com and .net domains and the <code>ServerName</code> use only the .com. Very important not to mix both.</p>

<p>Now that both configuration is created, let's enable them.</p>
<pre>
ln -s /etc/apache2/sites-available/domain1.conf /etc/apache2/sites-enabled/
ln -s /etc/apache2/sites-available/domain2.conf /etc/apache2/sites-enabled/
</pre>

<p>By creating the symbolic link, you can easily enable (create a symlink) or disable (delete the symlink) the website.</p>
<p>Now, re-start the web server:</p>
<pre>
/etc/init.d/apache2 restart
</pre>
<p>If everything went well, when you go to the domain1.com you will see your website and when you go to the domain2.com or domain2.net you will see the other website.</p>



	<br/><br/>
</article>

	<footer> 

		<h6>More links</h6>
		<a href="/about/" title="About">About</a>
		<a href="/codebase/" title="Codebase">CodeBase</a>
		<a href="/contribute/" title="Contribute">Contribute</a>

		<h6>NewsLetters</h6>
		<a href="http://eepurl.com/nCBQb" class="nw signUp">Sign up for our free newsletter!</a>
		<a href="http://bookofzeus.us5.list-manage.com/unsubscribe?u=6d11dcc020299e18618aa63a0&amp;id=f144c95830" class="nw unsub">Unsubscribe from our newsletter</a>
		<a href="http://eepurl.com/nCBVX" class="nw powered">Powered by MailChimp</a>

		<div>&copy; 2011-2018 Book Of Zeus</div>
		<p>
			All articles, code or tutorials listed on bookofzeus.com can be used as reference, links or as in a sharing matter without attribution.
			You cannot copy whole tutorials (unless permission is given), either translating to another language.
			By using and/or reading this site, you agree to our <a href="/privacy-policy/" title="Privacy Policy">privacy policy</a> and <a href="/terms-of-conditions" title="terms and conditions">terms and conditions</a>.
		</p>

	</footer>

</section>

<!--
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
-->
<script src="/media/main.js"></script>

<script>

document.getElementById("home").addEventListener("click", function(e) {
	window.location.href = 'http://bookofzeus.com';
	e.preventDefault();
});
document.getElementById("home2").addEventListener("click", function(e) {
	window.location.href = 'http://bookofzeus.com';
	e.preventDefault();
});

var els = document.getElementsByTagName("a"), els_length = els.length;
for (var i = 0, l = els_length; i < l; i++) {
    var el = els[i];
    if (el.href.replace('http://bookofzeus.com','') == window.location.pathname) {
        el.className= "selected";
    }
}

</script>

</body>
</html>